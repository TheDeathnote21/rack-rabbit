#!/usr/bin/env ruby
# encoding: utf-8

LIB = File.expand_path("../lib", File.dirname(__FILE__))
$LOAD_PATH.push LIB

require 'rack-rabbit'
require 'optparse'

action  = :run
options = {
}

op = OptionParser.new
op.banner = "#{RackRabbit::SUMMARY}\n\nUsage: rack-rabbit [options]"

op.on("-h", "--help")    { action = :help    }
op.on("-v", "--version") { action = :version }

begin
  op.parse!(ARGV)
  case action
  when :help    then puts op.to_s
  when :version then puts RackRabbit::VERSION
  else
    RackRabbit.run!(options)
  end
rescue Exception => ex
  puts ex.message
  abort
end
